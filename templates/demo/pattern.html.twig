{% extends 'base.html.twig' %}

{% block title %}DÃ©mo du Design Pattern Strategy{% endblock %}

{% block body %}

<div class="example-wrapper">
    <h1>ğŸŒ¾ DÃ©mo du Design Pattern Strategy</h1>

    {{ include('demo/_navigation.html.twig') }}

    <div class="strategy-info">
        <h3>ğŸ“‹ Informations sur les stratÃ©gies</h3>
        <p><strong>Nombre de stratÃ©gies disponibles :</strong> {{ strategies_count }}</p>
        <p>Chaque type de cÃ©rÃ©al utilise une stratÃ©gie d'analyse spÃ©cifique :</p>
        <ul>
            <li><strong>BlÃ©Analyse</strong> : Analyse spÃ©cifique au blÃ©</li>
            <li><strong>OrgeAnalyse</strong> : Analyse spÃ©cifique Ã  l'orge (avec fibres)</li>
            <li><strong>TournesolAnalyse</strong> : Analyse spÃ©cifique au tournesol (avec vitamine E et acide olÃ©ique)</li>
        </ul>

        <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 6px; border-left: 4px solid #6c757d;">
            <h4 style="color: #495057; margin-bottom: 15px;">ğŸ“ Code Source - Architecture Strategy Pattern</h4>
            <p style="color: #6c757d; margin-bottom: 15px;">Consultez l'implÃ©mentation complÃ¨te sur GitHub :</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                <a href="https://github.com/ludovicdevio/Design-Pattern-Strategy-Symfony/blob/main/src/Service/Strategy/AnalyseCerealInterface.php"
                   target="_blank"
                   style="color: #007bff; text-decoration: none; font-weight: bold; display: block; padding: 8px; background: white; border-radius: 4px; border: 1px solid #dee2e6;">
                    ğŸ”— Interface
                </a>
                <a href="https://github.com/ludovicdevio/Design-Pattern-Strategy-Symfony/blob/main/src/Service/Strategy/CerealAnalyseManager.php"
                   target="_blank"
                   style="color: #007bff; text-decoration: none; font-weight: bold; display: block; padding: 8px; background: white; border-radius: 4px; border: 1px solid #dee2e6;">
                    ğŸ”— Manager
                </a>
                <a href="https://github.com/ludovicdevio/Design-Pattern-Strategy-Symfony/blob/main/src/Service/Strategy/BleAnalyse.php"
                   target="_blank"
                   style="color: #007bff; text-decoration: none; font-weight: bold; display: block; padding: 8px; background: white; border-radius: 4px; border: 1px solid #dee2e6;">
                    ğŸ”— BlÃ©Analyse
                </a>
                <a href="https://github.com/ludovicdevio/Design-Pattern-Strategy-Symfony/blob/main/src/Service/Strategy/OrgeAnalyse.php"
                   target="_blank"
                   style="color: #007bff; text-decoration: none; font-weight: bold; display: block; padding: 8px; background: white; border-radius: 4px; border: 1px solid #dee2e6;">
                    ğŸ”— OrgeAnalyse
                </a>
                <a href="https://github.com/ludovicdevio/Design-Pattern-Strategy-Symfony/blob/main/src/Service/Strategy/TournesolAnalyse.php"
                   target="_blank"
                   style="color: #007bff; text-decoration: none; font-weight: bold; display: block; padding: 8px; background: white; border-radius: 4px; border: 1px solid #dee2e6;">
                    ğŸ”— TournesolAnalyse
                </a>
            </div>
        </div>

        <div style="margin-top: 20px; padding: 20px; background: #e3f2fd; border-radius: 8px; border-left: 4px solid #2196f3;">
            <h4 style="color: #1976d2; margin-bottom: 15px;">ğŸ”§ Attributs Symfony - Injection de DÃ©pendances</h4>
            <p style="color: #2c3e50; margin-bottom: 15px;">Ce projet utilise des attributs Symfony modernes pour l'injection automatique des stratÃ©gies :</p>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
                <div style="background: white; padding: 15px; border-radius: 6px; border: 1px solid #bbdefb;">
                    <h5 style="color: #1976d2; margin-bottom: 10px;">ğŸ·ï¸ #[AutoconfigureTag]</h5>
                    <p style="color: #2c3e50; font-size: 0.9em; margin-bottom: 10px;">Sur l'interface <code>AnalyseCerealInterface</code> :</p>
                    <div style="background: #f5f5f5; padding: 10px; border-radius: 4px; font-family: monospace; font-size: 0.8em;">
                        <code style="color: #d32f2f;">#[AutoconfigureTag('app.analyse_cereal')]</code><br>
                        <code style="color: #2c3e50;">interface AnalyseCerealInterface</code>
                    </div>
                    <p style="color: #666; font-size: 0.8em; margin-top: 8px;">â†’ <strong>Marque automatiquement</strong> toutes les classes qui implÃ©mentent cette interface avec le tag <code>app.analyse_cereal</code></p>
                </div>

                <div style="background: white; padding: 15px; border-radius: 6px; border: 1px solid #bbdefb;">
                    <h5 style="color: #1976d2; margin-bottom: 10px;">ğŸ”„ #[AutowireIterator]</h5>
                    <p style="color: #2c3e50; font-size: 0.9em; margin-bottom: 10px;">Dans le constructeur du <code>CerealAnalyseManager</code> :</p>
                    <div style="background: #f5f5f5; padding: 10px; border-radius: 4px; font-family: monospace; font-size: 0.8em;">
                        <code style="color: #d32f2f;">#[AutowireIterator(tag: 'app.analyse_cereal')]</code><br>
                        <code style="color: #2c3e50;">private iterable $strategies</code>
                    </div>
                    <p style="color: #666; font-size: 0.8em; margin-top: 8px;">â†’ <strong>Injecte automatiquement</strong> toutes les stratÃ©gies taguÃ©es dans un itÃ©rable</p>
                </div>
            </div>

            <div style="background: #fff3cd; padding: 15px; border-radius: 6px; border-left: 4px solid #ffc107;">
                <h5 style="color: #856404; margin-bottom: 10px;">ğŸ’¡ Avantages de cette approche</h5>
                <ul style="color: #856404; font-size: 0.9em; margin: 0; padding-left: 20px;">
                    <li><strong>Configuration automatique</strong> : Plus besoin de configurer manuellement chaque stratÃ©gie</li>
                    <li><strong>ExtensibilitÃ©</strong> : Ajouter une nouvelle stratÃ©gie = crÃ©er une classe qui implÃ©mente l'interface</li>
                    <li><strong>DÃ©couplage</strong> : Le manager ne connaÃ®t pas les stratÃ©gies concrÃ¨tes</li>
                    <li><strong>Performance</strong> : Symfony optimise l'injection de dÃ©pendances</li>
                </ul>
            </div>
        </div>
    </div>

    {% for analysis in analyses %}
        <div class="cereal-card">
            <div class="cereal-name">{{ analysis.cereal }}</div>

            {% if analysis.success %}
                <div class="analysis-result pattern">
                    <strong>RÃ©sultat de l'analyse :</strong><br>
                    {{ analysis.analyse }}
                </div>
            {% else %}
                <div class="error">
                    <strong>Erreur :</strong> {{ analysis.error }}
                </div>
            {% endif %}
        </div>
    {% endfor %}

    <div class="advantages-section">
        <h3>âœ… Avantages du Design Pattern Strategy</h3>
        <ul>
            <li><strong>ExtensibilitÃ© :</strong> Facile d'ajouter de nouveaux types de cÃ©rÃ©ales</li>
            <li><strong>MaintenabilitÃ© :</strong> Chaque stratÃ©gie est isolÃ©e et indÃ©pendante</li>
            <li><strong>FlexibilitÃ© :</strong> Le comportement peut Ãªtre changÃ© Ã  l'exÃ©cution</li>
            <li><strong>Principe ouvert/fermÃ© :</strong> Ouvert Ã  l'extension, fermÃ© Ã  la modification</li>
            <li><strong>TestabilitÃ© :</strong> Chaque stratÃ©gie peut Ãªtre testÃ©e individuellement</li>
            <li><strong>Injection de dÃ©pendances :</strong> Symfony gÃ¨re automatiquement l'injection</li>
        </ul>
    </div>

    {{ include('demo/_comparison_table.html.twig') }}

    <div class="conclusion-section">
        <h3>ğŸ’¡ Conclusion</h3>
        <p><strong>Le Design Pattern Strategy est la meilleure solution car il :</strong></p>
        <ul>
            <li>ğŸ¯ Respecte les principes SOLID</li>
            <li>ğŸ”§ Facilite la maintenance et l'extension</li>
            <li>ğŸ§ª AmÃ©liore la testabilitÃ©</li>
            <li>ğŸ“ˆ Permet l'Ã©volution du code sans modification</li>
            <li>âš¡ S'intÃ¨gre parfaitement avec Symfony et l'injection de dÃ©pendances</li>
        </ul>

        <p><strong>â†’ <a href="{{ path('app_demo_if') }}">Voir la version If/Else</a> |
        <a href="{{ path('app_demo_match') }}">Voir la version Match</a></strong></p>
    </div>
</div>
{% endblock %}
